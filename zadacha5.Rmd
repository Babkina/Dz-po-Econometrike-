---
title: "zadacha5"
author: "Anastasia"
date: '31 октября 2016 г '
output: html_document
---

Что скрывает Google?

# Пункт 1 
```{r goog}
plot(goog)
```
По полученным диаграммам рассеяния можно заметить,что отношения между переменной complied и другими,весьма разное.Есть связи,в которых нет выбросов,например,с переменными requests и dem.Но с переменными pop,hdi есть очевидные выбросы на диаграмме.

# Пункт 2 
```{r goog}
which.max (goog$pop)
goog_sub = subset (goog, goog$country! = "india")
plot(goog_sub)
```
Было определено,что страна с самой высокой численностью населения-это Индия.Индия-это 10 наблюдение в наборе данных.Население остальных стран не сильно отличается от общей массы,но видно,что например США-вторая по численности страна,Бразилия-третья.

# Пункт 3 
```{r}
table(goog_sub$dem)
goog_sub$dem=relevel(goog_sub$dem,ref=”hybrid”)
```

С помощью функции table была построена частотная таблица для переменной dem(уровня демократии в странах).Уровень free-является отсчётом по умолчанию.С помошью функции relevel() был изменён уровень отсчёта на hybrid.

# Пункт 4 
```{r}
fit2 = lm (complied~requests+pop+hdi+dem+internet+ freepress, data = goog_sub)
summary (fit2)
```
Нет значимых переменных в данном уравнении регрессии, так как Pr(>|t|)>0.1.Коэффициент детерминации R^2=0.4559,показывает,что наша модель объясняет 45,59 % дисперсий изменения зависимой переменной.Можно заметить,что в данном случае присутствует проблема мультиколлинеарности.

# Пункт 5 
```{r}
predict (fit2)
predict(fit2,newdata=new.request,interval="prediction")
```
США-это 26 строчка этого набора данных. Предсказанная доля выполненных запросов для США на основе модели составляет 94.790796% запросов, которые выполнил Google, на основе объясняющих переменных.

# Пункт 6 
```{r}
fit2$residuals
plot(fit2$residuals)
```
С помощью функции residuals были получены остатки.Также была построена диаграмма рассеяния остатков.По ней можно сделать вывод,что связь между остатками преимущественно линейная и рассеяние вокруг линии является абсолютным шумом. При росте предсказанных значений вариабельность остатков остается константой. 

# Пункт 7 
```{r}
fit25<-lm(complied~requests+pop+hdi+dem,data=goog_sub)
stepAIC(fit25,direction="backward")
```
Был реализован алгоритм регрессии методом пошагового исключения переменных.В ходе алгоритма были удалены переменные с наименьшим значением AIC,а именно requests и dem.Можно сделать вывод,что переменная complied зависит от двух переменных: от pop и hdi.
